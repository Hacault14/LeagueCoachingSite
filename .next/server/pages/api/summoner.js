"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/summoner";
exports.ids = ["pages/api/summoner"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsummoner&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csummoner.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsummoner&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csummoner.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_summoner_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\summoner.ts */ \"(api)/./src/pages/api/summoner.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_summoner_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_summoner_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/summoner\",\n        pathname: \"/api/summoner\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_summoner_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnN1bW1vbmVyJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTVDcGFnZXMlNUNhcGklNUNzdW1tb25lci50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMyRDtBQUMzRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovLy8/NDU3ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjXFxcXHBhZ2VzXFxcXGFwaVxcXFxzdW1tb25lci50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N1bW1vbmVyXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3VtbW9uZXJcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsummoner&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csummoner.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/summoner.ts":
/*!***********************************!*\
  !*** ./src/pages/api/summoner.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\nconst REGION_ROUTING = {\n    \"na1\": \"americas\",\n    \"euw1\": \"europe\",\n    \"kr\": \"asia\",\n    \"br1\": \"americas\",\n    \"eun1\": \"europe\",\n    \"jp1\": \"asia\",\n    \"la1\": \"americas\",\n    \"la2\": \"americas\",\n    \"oc1\": \"sea\",\n    \"tr1\": \"europe\",\n    \"ru\": \"europe\"\n};\nasync function getMatchDetails(matchId, region, apiKey) {\n    const routingValue = REGION_ROUTING[region] || \"americas\";\n    const response = await fetch(`https://${routingValue}.api.riotgames.com/lol/match/v5/matches/${matchId}`, {\n        headers: {\n            \"X-Riot-Token\": apiKey\n        }\n    });\n    if (!response.ok) {\n        console.error(`Failed to fetch match ${matchId}:`, await response.text());\n        return null;\n    }\n    return response.json();\n}\nasync function getRankedStats(summonerId, region, apiKey) {\n    const response = await fetch(`https://${region}.api.riotgames.com/lol/league/v4/entries/by-summoner/${summonerId}`, {\n        headers: {\n            \"X-Riot-Token\": apiKey\n        }\n    });\n    if (!response.ok) {\n        console.error(\"Failed to fetch ranked stats:\", await response.text());\n        return null;\n    }\n    return response.json();\n}\nfunction calculateChampionStats(matches, puuid) {\n    if (!matches || matches.length === 0) {\n        console.warn(\"No matches provided for champion stats calculation\");\n        return [];\n    }\n    const championStats = {};\n    let validMatchesCount = 0;\n    matches.forEach((match, index)=>{\n        if (!match || !match.info) {\n            console.warn(`Invalid match data at index ${index}`);\n            return;\n        }\n        // Skip remade games (games shorter than 5 minutes)\n        if (match.info.gameDuration < 300) {\n            console.log(`Skipping remade game ${match.info.gameId}`);\n            return;\n        }\n        // Only process ranked games\n        if (match.info.queueId !== 420 && match.info.queueId !== 440) {\n            console.log(`Skipping non-ranked game ${match.info.gameId} (Queue: ${match.info.queueId})`);\n            return;\n        }\n        const playerStats = match.info.participants.find((p)=>p.puuid === puuid);\n        if (!playerStats) {\n            console.warn(`Player not found in match ${match.info.gameId}`);\n            return;\n        }\n        validMatchesCount++;\n        const championName = playerStats.championName;\n        const gameDurationMinutes = match.info.gameDuration / 60;\n        if (!championStats[championName]) {\n            championStats[championName] = {\n                championName,\n                gamesPlayed: 0,\n                wins: 0,\n                totalKills: 0,\n                totalDeaths: 0,\n                totalAssists: 0,\n                totalCS: 0,\n                totalGameDuration: 0,\n                totalVisionScore: 0\n            };\n        }\n        championStats[championName].gamesPlayed++;\n        championStats[championName].wins += playerStats.win ? 1 : 0;\n        championStats[championName].totalKills += playerStats.kills || 0;\n        championStats[championName].totalDeaths += playerStats.deaths || 0;\n        championStats[championName].totalAssists += playerStats.assists || 0;\n        championStats[championName].totalCS += (playerStats.totalMinionsKilled || 0) + (playerStats.neutralMinionsKilled || 0);\n        championStats[championName].totalGameDuration += gameDurationMinutes;\n        championStats[championName].totalVisionScore += playerStats.visionScore || 0;\n    });\n    console.log(`Processed ${validMatchesCount} valid ranked matches out of ${matches.length} total matches`);\n    if (validMatchesCount === 0) {\n        console.warn(\"No valid ranked matches found for champion stats calculation\");\n        return [];\n    }\n    return Object.values(championStats).map((stats)=>({\n            championName: stats.championName,\n            gamesPlayed: stats.gamesPlayed,\n            winRate: (stats.wins / stats.gamesPlayed * 100).toFixed(1),\n            avgKills: (stats.totalKills / stats.gamesPlayed).toFixed(1),\n            avgDeaths: (stats.totalDeaths / stats.gamesPlayed).toFixed(1),\n            avgAssists: (stats.totalAssists / stats.gamesPlayed).toFixed(1),\n            kda: ((stats.totalKills + stats.totalAssists) / Math.max(1, stats.totalDeaths)).toFixed(2),\n            avgCSPerMin: (stats.totalCS / stats.totalGameDuration).toFixed(1),\n            avgCSPerGame: Math.round(stats.totalCS / stats.gamesPlayed),\n            avgVisionScore: (stats.totalVisionScore / stats.gamesPlayed).toFixed(1)\n        })).sort((a, b)=>b.gamesPlayed - a.gamesPlayed); // Sort by most played\n}\nfunction calculateRoleStats(matches, puuid) {\n    const roleStats = {\n        Top: {\n            games: 0,\n            wins: 0,\n            percentage: 0\n        },\n        Jungle: {\n            games: 0,\n            wins: 0,\n            percentage: 0\n        },\n        Mid: {\n            games: 0,\n            wins: 0,\n            percentage: 0\n        },\n        ADC: {\n            games: 0,\n            wins: 0,\n            percentage: 0\n        },\n        Support: {\n            games: 0,\n            wins: 0,\n            percentage: 0\n        }\n    };\n    // Filter for only ranked games (420 is Solo/Duo, 440 is Flex)\n    const validMatches = matches.filter((match)=>match && match.info.gameDuration >= 300 && // Skip remakes\n        (match.info.queueId === 420 || match.info.queueId === 440 // Only ranked games\n        ));\n    validMatches.forEach((match)=>{\n        const playerStats = match.info.participants.find((p)=>p.puuid === puuid);\n        if (!playerStats) return;\n        // Use teamPosition for more accurate role detection\n        const role = determineRole(playerStats);\n        if (role in roleStats) {\n            roleStats[role].games++;\n            roleStats[role].wins += playerStats.win ? 1 : 0;\n        }\n    });\n    // Calculate percentages based only on ranked games\n    const totalGames = validMatches.length;\n    Object.keys(roleStats).forEach((role)=>{\n        roleStats[role].percentage = roleStats[role].games / totalGames * 100;\n    });\n    return roleStats;\n}\nfunction createCoachingPrompt(rankedStats, championStats, roleStats) {\n    if (!rankedStats || championStats.length === 0) {\n        return \"No ranked data available for analysis.\";\n    }\n    const soloQueue = rankedStats.find((queue)=>queue.queueType === \"RANKED_SOLO_5x5\");\n    const rankedInfo = soloQueue ? `\r\nRanked Profile:\r\n- Tier: ${soloQueue.tier} ${soloQueue.rank}\r\n- LP: ${soloQueue.leaguePoints}\r\n- Win Rate: ${(soloQueue.wins / (soloQueue.wins + soloQueue.losses) * 100).toFixed(1)}%\r\n- Total Games: ${soloQueue.wins + soloQueue.losses}` : \"No Solo Queue data available.\";\n    const roleSection = `\r\nRole Distribution:\r\n${Object.entries(roleStats).filter(([_, stats])=>stats.games > 0).sort(([_, a], [__, b])=>b.games - a.games).map(([role, stats])=>`${role}: ${stats.games} games (${stats.percentage.toFixed(1)}% of games, ${(stats.wins / stats.games * 100).toFixed(1)}% WR)`).join(\"\\n\")}`;\n    const championSection = championStats.length > 0 ? `\r\nChampion Statistics (Ranked Season):\r\n${championStats.map((champ)=>`\r\n${champ.championName} (${champ.gamesPlayed} games):\r\n- Win Rate: ${champ.winRate}%\r\n- KDA: ${champ.avgKills}/${champ.avgDeaths}/${champ.avgAssists} (${champ.kda})\r\n- CS/min: ${champ.avgCSPerMin}\r\n- Vision Score: ${champ.avgVisionScore}`).join(\"\\n\")}` : \"\";\n    return `As a League of Legends coach, analyze this player's ranked season performance: \r\n${rankedInfo}\r\n${roleSection}\r\n${championSection}\r\n\r\nAnalyze the provided statistics and provide 3 goals, each accompanied by 3 actionable suggestions for improvement.\r\n\r\nTo help you choose the goals, here are some rules in the following format:\r\n- [player tendency]: [goal]\r\n\r\n- The player is playing their main role in less than 80% of their games: Stick to Main Role\r\n- The player has more than 5 games on a champion that is not in their top 3 most played champions: Stick to Main Champions\r\n- The player has on average more than 5 deaths: Minimize Deaths\r\n- The player has on average less than 7 CS/min: Improve CS/min\r\n`;\n}\nasync function getMatchDetailsWithRateLimit(matchIds, region, apiKey) {\n    const matchDetails = [];\n    const batchSize = 20; // Process 20 requests at a time\n    // Split matchIds into batches of 20\n    for(let i = 0; i < matchIds.length; i += batchSize){\n        const batch = matchIds.slice(i, i + batchSize);\n        // Process batch\n        const batchResults = await Promise.all(batch.map((matchId)=>getMatchDetails(matchId, region, apiKey)));\n        matchDetails.push(...batchResults);\n        // If there are more batches to process, wait 1 second\n        if (i + batchSize < matchIds.length) {\n            await new Promise((resolve)=>setTimeout(resolve, 1000));\n        }\n    }\n    return matchDetails;\n}\nfunction determineRole(playerStats) {\n    // Use teamPosition as primary indicator (most reliable for ranked games)\n    if (playerStats.teamPosition) {\n        const positions = {\n            \"TOP\": \"Top\",\n            \"JUNGLE\": \"Jungle\",\n            \"MIDDLE\": \"Mid\",\n            \"BOTTOM\": \"ADC\",\n            \"UTILITY\": \"Support\"\n        };\n        return positions[playerStats.teamPosition] || playerStats.teamPosition;\n    }\n    // Fallback to individualPosition if teamPosition is not available\n    if (playerStats.individualPosition && playerStats.individualPosition !== \"Invalid\") {\n        const positions = {\n            \"TOP\": \"Top\",\n            \"JUNGLE\": \"Jungle\",\n            \"MIDDLE\": \"Mid\",\n            \"BOTTOM\": \"ADC\",\n            \"UTILITY\": \"Support\"\n        };\n        return positions[playerStats.individualPosition] || playerStats.individualPosition;\n    }\n    return \"Unknown\";\n}\nasync function getAccountData(gameName, tagLine, apiKey) {\n    const response = await fetch(`https://americas.api.riotgames.com/riot/account/v1/accounts/by-riot-id/${encodeURIComponent(gameName)}/${encodeURIComponent(tagLine)}`, {\n        headers: {\n            \"X-Riot-Token\": apiKey\n        }\n    });\n    if (!response.ok) {\n        console.error(\"Failed to fetch account data:\", await response.text());\n        return null;\n    }\n    return response.json();\n}\nasync function getSummonerData(puuid, region, apiKey) {\n    const response = await fetch(`https://${region}.api.riotgames.com/lol/summoner/v4/summoners/by-puuid/${puuid}`, {\n        headers: {\n            \"X-Riot-Token\": apiKey\n        }\n    });\n    if (!response.ok) {\n        console.error(\"Failed to fetch summoner data:\", await response.text());\n        return null;\n    }\n    return response.json();\n}\nasync function getMatchIds(puuid, region, apiKey) {\n    const routingValue = REGION_ROUTING[region] || \"americas\";\n    // First get all recent matches without queue filter\n    const response = await fetch(`https://${routingValue}.api.riotgames.com/lol/match/v5/matches/by-puuid/${puuid}/ids?start=0&count=100`, {\n        headers: {\n            \"X-Riot-Token\": apiKey\n        }\n    });\n    if (!response.ok) {\n        console.error(\"Failed to fetch match IDs:\", await response.text());\n        return null;\n    }\n    const allMatches = await response.json();\n    console.log(`Found ${allMatches.length} total matches`);\n    // Get details for the first few matches to determine their queue types\n    const firstBatch = allMatches.slice(0, 20); // Check first 20 matches\n    const matchDetails = await Promise.all(firstBatch.map((matchId)=>getMatchDetails(matchId, region, apiKey)));\n    // Filter for ranked games (queue IDs 420 and 440)\n    const rankedMatches = matchDetails.filter((match)=>match !== null && (match.info.queueId === 420 || match.info.queueId === 440)).map((match)=>match.metadata.matchId);\n    console.log(`Found ${rankedMatches.length} ranked matches out of ${firstBatch.length} checked matches`);\n    return rankedMatches;\n}\nasync function handler(req, res) {\n    try {\n        const { gameName, tagLine, region = \"na1\" } = req.query;\n        if (!gameName || !tagLine) {\n            return res.status(400).json({\n                error: \"Game name and tag line are required\"\n            });\n        }\n        if (!process.env.RIOT_API_KEY) {\n            console.error(\"RIOT_API_KEY is not set in environment variables\");\n            return res.status(500).json({\n                error: \"Server configuration error\"\n            });\n        }\n        try {\n            console.log(`Fetching data for ${gameName}#${tagLine} in region ${region}`);\n            // Step 1: Get PUUID using Riot ID\n            const accountData = await getAccountData(gameName, tagLine, process.env.RIOT_API_KEY);\n            if (!accountData) {\n                console.error(\"Account not found for:\", gameName, tagLine);\n                return res.status(404).json({\n                    error: \"Account not found\"\n                });\n            }\n            console.log(\"Account found:\", accountData.puuid);\n            // Step 2: Get summoner data using PUUID\n            const summonerData = await getSummonerData(accountData.puuid, region, process.env.RIOT_API_KEY);\n            if (!summonerData) {\n                console.error(\"Summoner data not found for PUUID:\", accountData.puuid);\n                return res.status(404).json({\n                    error: \"Summoner data not found\"\n                });\n            }\n            console.log(\"Summoner data found:\", summonerData.id);\n            // Step 3: Get ranked stats\n            const rankedStats = await getRankedStats(summonerData.id, region, process.env.RIOT_API_KEY);\n            if (!rankedStats) {\n                console.warn(\"No ranked stats found for summoner:\", summonerData.id);\n            } else {\n                console.log(\"Found ranked stats:\", rankedStats.length, \"queues\");\n            }\n            // Step 4: Get match IDs\n            const matchIds = await getMatchIds(accountData.puuid, region, process.env.RIOT_API_KEY);\n            if (!matchIds || matchIds.length === 0) {\n                console.error(\"No matches found for PUUID:\", accountData.puuid);\n                return res.status(404).json({\n                    error: \"No ranked matches found\",\n                    details: \"The player has no recent ranked games in Solo Queue or Flex Queue\"\n                });\n            }\n            console.log(`Found ${matchIds.length} total matches`);\n            // Step 5: Get match details with rate limiting\n            console.log(`Fetching details for ${matchIds.length} matches...`);\n            const matchDetails = await getMatchDetailsWithRateLimit(matchIds.slice(0, 20), region, process.env.RIOT_API_KEY);\n            const validMatches = matchDetails.filter((match)=>match !== null);\n            if (validMatches.length === 0) {\n                console.error(\"No valid matches found after filtering\");\n                return res.status(404).json({\n                    error: \"No valid matches found\",\n                    details: \"Could not retrieve details for any of the matches\"\n                });\n            }\n            console.log(`Successfully fetched ${validMatches.length} valid matches out of ${matchIds.length} total matches`);\n            // Step 6: Calculate stats\n            const championStats = calculateChampionStats(validMatches, accountData.puuid);\n            const roleStats = calculateRoleStats(validMatches, accountData.puuid);\n            const mainRole = Object.entries(roleStats).sort(([_, a], [__, b])=>b.games - a.games).map(([role, stats])=>({\n                    role,\n                    stats\n                }))[0];\n            // Step 7: Create coaching prompt\n            const coachingPrompt = createCoachingPrompt(rankedStats, championStats, roleStats);\n            // Return all data\n            res.status(200).json({\n                account: accountData,\n                summoner: summonerData,\n                rankedStats,\n                championStats,\n                roleStats,\n                mainRole,\n                coachingPrompt,\n                debug: {\n                    totalMatches: matchIds.length,\n                    validMatches: validMatches.length,\n                    processedChampions: championStats.length,\n                    region: region,\n                    routingValue: REGION_ROUTING[region] || \"americas\"\n                }\n            });\n        } catch (error) {\n            console.error(\"Detailed error:\", error);\n            res.status(500).json({\n                error: \"Failed to fetch data\",\n                details: error instanceof Error ? error.message : \"Unknown error\",\n                path: error?.response?.url || \"Unknown path\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Detailed error:\", error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\",\n            details: error.message\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGNBQWNGLE1BQU07b0JBQ3hDaEIsUUFBUUE7b0JBQ1JFLGNBQWNMLGNBQWMsQ0FBQ0csT0FBTyxJQUFJO2dCQUMxQztZQUNGO1FBRUYsRUFBRSxPQUFPUSxPQUFZO1lBQ25CRCxRQUFRQyxLQUFLLENBQUMsbUJBQW1CQTtZQUNqQ3dILElBQUlFLE1BQU0sQ0FBQyxLQUFLeEgsSUFBSSxDQUFDO2dCQUNuQkYsT0FBTztnQkFDUGlJLFNBQVNqSSxpQkFBaUJ5SSxRQUFRekksTUFBTTBJLE9BQU8sR0FBRztnQkFDbERDLE1BQU0zSSxPQUFPTCxVQUFVaUosT0FBTztZQUNoQztRQUNGO0lBQ0YsRUFBRSxPQUFPNUksT0FBWTtRQUNuQkQsUUFBUUMsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakN3SCxJQUFJRSxNQUFNLENBQUMsS0FBS3hILElBQUksQ0FBQztZQUFFRixPQUFPO1lBQW1EaUksU0FBU2pJLE1BQU0wSSxPQUFPO1FBQUM7SUFDMUc7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9wYWdlcy9hcGkvc3VtbW9uZXIudHM/NjUyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0J1xyXG5cclxuY29uc3QgUkVHSU9OX1JPVVRJTkc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XHJcbiAgJ25hMSc6ICdhbWVyaWNhcycsXHJcbiAgJ2V1dzEnOiAnZXVyb3BlJyxcclxuICAna3InOiAnYXNpYScsXHJcbiAgJ2JyMSc6ICdhbWVyaWNhcycsXHJcbiAgJ2V1bjEnOiAnZXVyb3BlJyxcclxuICAnanAxJzogJ2FzaWEnLFxyXG4gICdsYTEnOiAnYW1lcmljYXMnLFxyXG4gICdsYTInOiAnYW1lcmljYXMnLFxyXG4gICdvYzEnOiAnc2VhJyxcclxuICAndHIxJzogJ2V1cm9wZScsXHJcbiAgJ3J1JzogJ2V1cm9wZScsXHJcbn1cclxuXHJcbmludGVyZmFjZSBDaGFtcGlvblN0YXRzIHtcclxuICBjaGFtcGlvbk5hbWU6IHN0cmluZztcclxuICBnYW1lc1BsYXllZDogbnVtYmVyO1xyXG4gIHdpbnM6IG51bWJlcjtcclxuICB0b3RhbEtpbGxzOiBudW1iZXI7XHJcbiAgdG90YWxEZWF0aHM6IG51bWJlcjtcclxuICB0b3RhbEFzc2lzdHM6IG51bWJlcjtcclxuICB0b3RhbENTOiBudW1iZXI7XHJcbiAgdG90YWxHYW1lRHVyYXRpb246IG51bWJlcjtcclxuICB0b3RhbFZpc2lvblNjb3JlOiBudW1iZXI7XHJcbn1cclxuXHJcbmludGVyZmFjZSBSb2xlU3RhdHMge1xyXG4gIGdhbWVzOiBudW1iZXI7XHJcbiAgd2luczogbnVtYmVyO1xyXG4gIHBlcmNlbnRhZ2U6IG51bWJlcjtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TWF0Y2hEZXRhaWxzKG1hdGNoSWQ6IHN0cmluZywgcmVnaW9uOiBzdHJpbmcsIGFwaUtleTogc3RyaW5nKSB7XHJcbiAgY29uc3Qgcm91dGluZ1ZhbHVlID0gUkVHSU9OX1JPVVRJTkdbcmVnaW9uXSB8fCAnYW1lcmljYXMnO1xyXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICBgaHR0cHM6Ly8ke3JvdXRpbmdWYWx1ZX0uYXBpLnJpb3RnYW1lcy5jb20vbG9sL21hdGNoL3Y1L21hdGNoZXMvJHttYXRjaElkfWAsXHJcbiAgICB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnWC1SaW90LVRva2VuJzogYXBpS2V5XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggbWF0Y2ggJHttYXRjaElkfTpgLCBhd2FpdCByZXNwb25zZS50ZXh0KCkpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRSYW5rZWRTdGF0cyhzdW1tb25lcklkOiBzdHJpbmcsIHJlZ2lvbjogc3RyaW5nLCBhcGlLZXk6IHN0cmluZykge1xyXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICBgaHR0cHM6Ly8ke3JlZ2lvbn0uYXBpLnJpb3RnYW1lcy5jb20vbG9sL2xlYWd1ZS92NC9lbnRyaWVzL2J5LXN1bW1vbmVyLyR7c3VtbW9uZXJJZH1gLFxyXG4gICAge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ1gtUmlvdC1Ub2tlbic6IGFwaUtleVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHJhbmtlZCBzdGF0czonLCBhd2FpdCByZXNwb25zZS50ZXh0KCkpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVDaGFtcGlvblN0YXRzKG1hdGNoZXM6IGFueVtdLCBwdXVpZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFtYXRjaGVzIHx8IG1hdGNoZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICBjb25zb2xlLndhcm4oJ05vIG1hdGNoZXMgcHJvdmlkZWQgZm9yIGNoYW1waW9uIHN0YXRzIGNhbGN1bGF0aW9uJyk7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICBjb25zdCBjaGFtcGlvblN0YXRzOiB7IFtrZXk6IHN0cmluZ106IENoYW1waW9uU3RhdHMgfSA9IHt9O1xyXG4gIGxldCB2YWxpZE1hdGNoZXNDb3VudCA9IDA7XHJcblxyXG4gIG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gsIGluZGV4KSA9PiB7XHJcbiAgICBpZiAoIW1hdGNoIHx8ICFtYXRjaC5pbmZvKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihgSW52YWxpZCBtYXRjaCBkYXRhIGF0IGluZGV4ICR7aW5kZXh9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTa2lwIHJlbWFkZSBnYW1lcyAoZ2FtZXMgc2hvcnRlciB0aGFuIDUgbWludXRlcylcclxuICAgIGlmIChtYXRjaC5pbmZvLmdhbWVEdXJhdGlvbiA8IDMwMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgU2tpcHBpbmcgcmVtYWRlIGdhbWUgJHttYXRjaC5pbmZvLmdhbWVJZH1gKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBPbmx5IHByb2Nlc3MgcmFua2VkIGdhbWVzXHJcbiAgICBpZiAobWF0Y2guaW5mby5xdWV1ZUlkICE9PSA0MjAgJiYgbWF0Y2guaW5mby5xdWV1ZUlkICE9PSA0NDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFNraXBwaW5nIG5vbi1yYW5rZWQgZ2FtZSAke21hdGNoLmluZm8uZ2FtZUlkfSAoUXVldWU6ICR7bWF0Y2guaW5mby5xdWV1ZUlkfSlgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBwbGF5ZXJTdGF0cyA9IG1hdGNoLmluZm8ucGFydGljaXBhbnRzLmZpbmQoXHJcbiAgICAgIChwOiBhbnkpID0+IHAucHV1aWQgPT09IHB1dWlkXHJcbiAgICApO1xyXG5cclxuICAgIGlmICghcGxheWVyU3RhdHMpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBQbGF5ZXIgbm90IGZvdW5kIGluIG1hdGNoICR7bWF0Y2guaW5mby5nYW1lSWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YWxpZE1hdGNoZXNDb3VudCsrO1xyXG4gICAgY29uc3QgY2hhbXBpb25OYW1lID0gcGxheWVyU3RhdHMuY2hhbXBpb25OYW1lO1xyXG4gICAgY29uc3QgZ2FtZUR1cmF0aW9uTWludXRlcyA9IG1hdGNoLmluZm8uZ2FtZUR1cmF0aW9uIC8gNjA7XHJcblxyXG4gICAgaWYgKCFjaGFtcGlvblN0YXRzW2NoYW1waW9uTmFtZV0pIHtcclxuICAgICAgY2hhbXBpb25TdGF0c1tjaGFtcGlvbk5hbWVdID0ge1xyXG4gICAgICAgIGNoYW1waW9uTmFtZSxcclxuICAgICAgICBnYW1lc1BsYXllZDogMCxcclxuICAgICAgICB3aW5zOiAwLFxyXG4gICAgICAgIHRvdGFsS2lsbHM6IDAsXHJcbiAgICAgICAgdG90YWxEZWF0aHM6IDAsXHJcbiAgICAgICAgdG90YWxBc3Npc3RzOiAwLFxyXG4gICAgICAgIHRvdGFsQ1M6IDAsXHJcbiAgICAgICAgdG90YWxHYW1lRHVyYXRpb246IDAsXHJcbiAgICAgICAgdG90YWxWaXNpb25TY29yZTogMFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW1waW9uU3RhdHNbY2hhbXBpb25OYW1lXS5nYW1lc1BsYXllZCsrO1xyXG4gICAgY2hhbXBpb25TdGF0c1tjaGFtcGlvbk5hbWVdLndpbnMgKz0gcGxheWVyU3RhdHMud2luID8gMSA6IDA7XHJcbiAgICBjaGFtcGlvblN0YXRzW2NoYW1waW9uTmFtZV0udG90YWxLaWxscyArPSBwbGF5ZXJTdGF0cy5raWxscyB8fCAwO1xyXG4gICAgY2hhbXBpb25TdGF0c1tjaGFtcGlvbk5hbWVdLnRvdGFsRGVhdGhzICs9IHBsYXllclN0YXRzLmRlYXRocyB8fCAwO1xyXG4gICAgY2hhbXBpb25TdGF0c1tjaGFtcGlvbk5hbWVdLnRvdGFsQXNzaXN0cyArPSBwbGF5ZXJTdGF0cy5hc3Npc3RzIHx8IDA7XHJcbiAgICBjaGFtcGlvblN0YXRzW2NoYW1waW9uTmFtZV0udG90YWxDUyArPSAocGxheWVyU3RhdHMudG90YWxNaW5pb25zS2lsbGVkIHx8IDApICsgKHBsYXllclN0YXRzLm5ldXRyYWxNaW5pb25zS2lsbGVkIHx8IDApO1xyXG4gICAgY2hhbXBpb25TdGF0c1tjaGFtcGlvbk5hbWVdLnRvdGFsR2FtZUR1cmF0aW9uICs9IGdhbWVEdXJhdGlvbk1pbnV0ZXM7XHJcbiAgICBjaGFtcGlvblN0YXRzW2NoYW1waW9uTmFtZV0udG90YWxWaXNpb25TY29yZSArPSBwbGF5ZXJTdGF0cy52aXNpb25TY29yZSB8fCAwO1xyXG4gIH0pO1xyXG5cclxuICBjb25zb2xlLmxvZyhgUHJvY2Vzc2VkICR7dmFsaWRNYXRjaGVzQ291bnR9IHZhbGlkIHJhbmtlZCBtYXRjaGVzIG91dCBvZiAke21hdGNoZXMubGVuZ3RofSB0b3RhbCBtYXRjaGVzYCk7XHJcblxyXG4gIGlmICh2YWxpZE1hdGNoZXNDb3VudCA9PT0gMCkge1xyXG4gICAgY29uc29sZS53YXJuKCdObyB2YWxpZCByYW5rZWQgbWF0Y2hlcyBmb3VuZCBmb3IgY2hhbXBpb24gc3RhdHMgY2FsY3VsYXRpb24nKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcblxyXG4gIHJldHVybiBPYmplY3QudmFsdWVzKGNoYW1waW9uU3RhdHMpXHJcbiAgICAubWFwKHN0YXRzID0+ICh7XHJcbiAgICAgIGNoYW1waW9uTmFtZTogc3RhdHMuY2hhbXBpb25OYW1lLFxyXG4gICAgICBnYW1lc1BsYXllZDogc3RhdHMuZ2FtZXNQbGF5ZWQsXHJcbiAgICAgIHdpblJhdGU6ICgoc3RhdHMud2lucyAvIHN0YXRzLmdhbWVzUGxheWVkKSAqIDEwMCkudG9GaXhlZCgxKSxcclxuICAgICAgYXZnS2lsbHM6IChzdGF0cy50b3RhbEtpbGxzIC8gc3RhdHMuZ2FtZXNQbGF5ZWQpLnRvRml4ZWQoMSksXHJcbiAgICAgIGF2Z0RlYXRoczogKHN0YXRzLnRvdGFsRGVhdGhzIC8gc3RhdHMuZ2FtZXNQbGF5ZWQpLnRvRml4ZWQoMSksXHJcbiAgICAgIGF2Z0Fzc2lzdHM6IChzdGF0cy50b3RhbEFzc2lzdHMgLyBzdGF0cy5nYW1lc1BsYXllZCkudG9GaXhlZCgxKSxcclxuICAgICAga2RhOiAoKHN0YXRzLnRvdGFsS2lsbHMgKyBzdGF0cy50b3RhbEFzc2lzdHMpIC8gTWF0aC5tYXgoMSwgc3RhdHMudG90YWxEZWF0aHMpKS50b0ZpeGVkKDIpLFxyXG4gICAgICBhdmdDU1Blck1pbjogKHN0YXRzLnRvdGFsQ1MgLyBzdGF0cy50b3RhbEdhbWVEdXJhdGlvbikudG9GaXhlZCgxKSxcclxuICAgICAgYXZnQ1NQZXJHYW1lOiBNYXRoLnJvdW5kKHN0YXRzLnRvdGFsQ1MgLyBzdGF0cy5nYW1lc1BsYXllZCksXHJcbiAgICAgIGF2Z1Zpc2lvblNjb3JlOiAoc3RhdHMudG90YWxWaXNpb25TY29yZSAvIHN0YXRzLmdhbWVzUGxheWVkKS50b0ZpeGVkKDEpXHJcbiAgICB9KSlcclxuICAgIC5zb3J0KChhLCBiKSA9PiBiLmdhbWVzUGxheWVkIC0gYS5nYW1lc1BsYXllZCk7IC8vIFNvcnQgYnkgbW9zdCBwbGF5ZWRcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlUm9sZVN0YXRzKG1hdGNoZXM6IGFueVtdLCBwdXVpZDogc3RyaW5nKSB7XHJcbiAgY29uc3Qgcm9sZVN0YXRzOiB7IFtrZXk6IHN0cmluZ106IFJvbGVTdGF0cyB9ID0ge1xyXG4gICAgVG9wOiB7IGdhbWVzOiAwLCB3aW5zOiAwLCBwZXJjZW50YWdlOiAwIH0sXHJcbiAgICBKdW5nbGU6IHsgZ2FtZXM6IDAsIHdpbnM6IDAsIHBlcmNlbnRhZ2U6IDAgfSxcclxuICAgIE1pZDogeyBnYW1lczogMCwgd2luczogMCwgcGVyY2VudGFnZTogMCB9LFxyXG4gICAgQURDOiB7IGdhbWVzOiAwLCB3aW5zOiAwLCBwZXJjZW50YWdlOiAwIH0sXHJcbiAgICBTdXBwb3J0OiB7IGdhbWVzOiAwLCB3aW5zOiAwLCBwZXJjZW50YWdlOiAwIH1cclxuICB9O1xyXG5cclxuICAvLyBGaWx0ZXIgZm9yIG9ubHkgcmFua2VkIGdhbWVzICg0MjAgaXMgU29sby9EdW8sIDQ0MCBpcyBGbGV4KVxyXG4gIGNvbnN0IHZhbGlkTWF0Y2hlcyA9IG1hdGNoZXMuZmlsdGVyKG1hdGNoID0+IFxyXG4gICAgbWF0Y2ggJiYgXHJcbiAgICBtYXRjaC5pbmZvLmdhbWVEdXJhdGlvbiA+PSAzMDAgJiYgLy8gU2tpcCByZW1ha2VzXHJcbiAgICAobWF0Y2guaW5mby5xdWV1ZUlkID09PSA0MjAgfHwgbWF0Y2guaW5mby5xdWV1ZUlkID09PSA0NDApIC8vIE9ubHkgcmFua2VkIGdhbWVzXHJcbiAgKTtcclxuXHJcbiAgdmFsaWRNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xyXG4gICAgY29uc3QgcGxheWVyU3RhdHMgPSBtYXRjaC5pbmZvLnBhcnRpY2lwYW50cy5maW5kKFxyXG4gICAgICAocDogYW55KSA9PiBwLnB1dWlkID09PSBwdXVpZFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoIXBsYXllclN0YXRzKSByZXR1cm47XHJcblxyXG4gICAgLy8gVXNlIHRlYW1Qb3NpdGlvbiBmb3IgbW9yZSBhY2N1cmF0ZSByb2xlIGRldGVjdGlvblxyXG4gICAgY29uc3Qgcm9sZSA9IGRldGVybWluZVJvbGUocGxheWVyU3RhdHMpO1xyXG4gICAgaWYgKHJvbGUgaW4gcm9sZVN0YXRzKSB7XHJcbiAgICAgIHJvbGVTdGF0c1tyb2xlXS5nYW1lcysrO1xyXG4gICAgICByb2xlU3RhdHNbcm9sZV0ud2lucyArPSBwbGF5ZXJTdGF0cy53aW4gPyAxIDogMDtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRhZ2VzIGJhc2VkIG9ubHkgb24gcmFua2VkIGdhbWVzXHJcbiAgY29uc3QgdG90YWxHYW1lcyA9IHZhbGlkTWF0Y2hlcy5sZW5ndGg7XHJcbiAgT2JqZWN0LmtleXMocm9sZVN0YXRzKS5mb3JFYWNoKHJvbGUgPT4ge1xyXG4gICAgcm9sZVN0YXRzW3JvbGVdLnBlcmNlbnRhZ2UgPSAocm9sZVN0YXRzW3JvbGVdLmdhbWVzIC8gdG90YWxHYW1lcykgKiAxMDA7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiByb2xlU3RhdHM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNvYWNoaW5nUHJvbXB0KHJhbmtlZFN0YXRzOiBhbnksIGNoYW1waW9uU3RhdHM6IGFueVtdLCByb2xlU3RhdHM6IGFueSkge1xyXG4gIGlmICghcmFua2VkU3RhdHMgfHwgY2hhbXBpb25TdGF0cy5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiAnTm8gcmFua2VkIGRhdGEgYXZhaWxhYmxlIGZvciBhbmFseXNpcy4nO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc29sb1F1ZXVlID0gcmFua2VkU3RhdHMuZmluZCgocXVldWU6IGFueSkgPT4gcXVldWUucXVldWVUeXBlID09PSAnUkFOS0VEX1NPTE9fNXg1Jyk7XHJcbiAgXHJcbiAgY29uc3QgcmFua2VkSW5mbyA9IHNvbG9RdWV1ZSA/IGBcclxuUmFua2VkIFByb2ZpbGU6XHJcbi0gVGllcjogJHtzb2xvUXVldWUudGllcn0gJHtzb2xvUXVldWUucmFua31cclxuLSBMUDogJHtzb2xvUXVldWUubGVhZ3VlUG9pbnRzfVxyXG4tIFdpbiBSYXRlOiAkeygoc29sb1F1ZXVlLndpbnMgLyAoc29sb1F1ZXVlLndpbnMgKyBzb2xvUXVldWUubG9zc2VzKSkgKiAxMDApLnRvRml4ZWQoMSl9JVxyXG4tIFRvdGFsIEdhbWVzOiAke3NvbG9RdWV1ZS53aW5zICsgc29sb1F1ZXVlLmxvc3Nlc31gIDogJ05vIFNvbG8gUXVldWUgZGF0YSBhdmFpbGFibGUuJztcclxuXHJcbiAgY29uc3Qgcm9sZVNlY3Rpb24gPSBgXHJcblJvbGUgRGlzdHJpYnV0aW9uOlxyXG4ke09iamVjdC5lbnRyaWVzKHJvbGVTdGF0cylcclxuICAuZmlsdGVyKChbXywgc3RhdHNdKSA9PiAoc3RhdHMgYXMgUm9sZVN0YXRzKS5nYW1lcyA+IDApXHJcbiAgLnNvcnQoKFtfLCBhXSwgW19fLCBiXSkgPT4gKGIgYXMgUm9sZVN0YXRzKS5nYW1lcyAtIChhIGFzIFJvbGVTdGF0cykuZ2FtZXMpXHJcbiAgLm1hcCgoW3JvbGUsIHN0YXRzXSkgPT4gXHJcbiAgICBgJHtyb2xlfTogJHsoc3RhdHMgYXMgUm9sZVN0YXRzKS5nYW1lc30gZ2FtZXMgKCR7KHN0YXRzIGFzIFJvbGVTdGF0cykucGVyY2VudGFnZS50b0ZpeGVkKDEpfSUgb2YgZ2FtZXMsICR7KCgoc3RhdHMgYXMgUm9sZVN0YXRzKS53aW5zIC8gKHN0YXRzIGFzIFJvbGVTdGF0cykuZ2FtZXMpICogMTAwKS50b0ZpeGVkKDEpfSUgV1IpYFxyXG4gICkuam9pbignXFxuJyl9YDtcclxuXHJcbiAgY29uc3QgY2hhbXBpb25TZWN0aW9uID0gY2hhbXBpb25TdGF0cy5sZW5ndGggPiAwID8gYFxyXG5DaGFtcGlvbiBTdGF0aXN0aWNzIChSYW5rZWQgU2Vhc29uKTpcclxuJHtjaGFtcGlvblN0YXRzLm1hcChjaGFtcCA9PiBgXHJcbiR7Y2hhbXAuY2hhbXBpb25OYW1lfSAoJHtjaGFtcC5nYW1lc1BsYXllZH0gZ2FtZXMpOlxyXG4tIFdpbiBSYXRlOiAke2NoYW1wLndpblJhdGV9JVxyXG4tIEtEQTogJHtjaGFtcC5hdmdLaWxsc30vJHtjaGFtcC5hdmdEZWF0aHN9LyR7Y2hhbXAuYXZnQXNzaXN0c30gKCR7Y2hhbXAua2RhfSlcclxuLSBDUy9taW46ICR7Y2hhbXAuYXZnQ1NQZXJNaW59XHJcbi0gVmlzaW9uIFNjb3JlOiAke2NoYW1wLmF2Z1Zpc2lvblNjb3JlfWApLmpvaW4oJ1xcbicpfWAgOiAnJztcclxuXHJcbiAgcmV0dXJuIGBBcyBhIExlYWd1ZSBvZiBMZWdlbmRzIGNvYWNoLCBhbmFseXplIHRoaXMgcGxheWVyJ3MgcmFua2VkIHNlYXNvbiBwZXJmb3JtYW5jZTogXHJcbiR7cmFua2VkSW5mb31cclxuJHtyb2xlU2VjdGlvbn1cclxuJHtjaGFtcGlvblNlY3Rpb259XHJcblxyXG5BbmFseXplIHRoZSBwcm92aWRlZCBzdGF0aXN0aWNzIGFuZCBwcm92aWRlIDMgZ29hbHMsIGVhY2ggYWNjb21wYW5pZWQgYnkgMyBhY3Rpb25hYmxlIHN1Z2dlc3Rpb25zIGZvciBpbXByb3ZlbWVudC5cclxuXHJcblRvIGhlbHAgeW91IGNob29zZSB0aGUgZ29hbHMsIGhlcmUgYXJlIHNvbWUgcnVsZXMgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XHJcbi0gW3BsYXllciB0ZW5kZW5jeV06IFtnb2FsXVxyXG5cclxuLSBUaGUgcGxheWVyIGlzIHBsYXlpbmcgdGhlaXIgbWFpbiByb2xlIGluIGxlc3MgdGhhbiA4MCUgb2YgdGhlaXIgZ2FtZXM6IFN0aWNrIHRvIE1haW4gUm9sZVxyXG4tIFRoZSBwbGF5ZXIgaGFzIG1vcmUgdGhhbiA1IGdhbWVzIG9uIGEgY2hhbXBpb24gdGhhdCBpcyBub3QgaW4gdGhlaXIgdG9wIDMgbW9zdCBwbGF5ZWQgY2hhbXBpb25zOiBTdGljayB0byBNYWluIENoYW1waW9uc1xyXG4tIFRoZSBwbGF5ZXIgaGFzIG9uIGF2ZXJhZ2UgbW9yZSB0aGFuIDUgZGVhdGhzOiBNaW5pbWl6ZSBEZWF0aHNcclxuLSBUaGUgcGxheWVyIGhhcyBvbiBhdmVyYWdlIGxlc3MgdGhhbiA3IENTL21pbjogSW1wcm92ZSBDUy9taW5cclxuYDtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TWF0Y2hEZXRhaWxzV2l0aFJhdGVMaW1pdChtYXRjaElkczogc3RyaW5nW10sIHJlZ2lvbjogc3RyaW5nLCBhcGlLZXk6IHN0cmluZykge1xyXG4gIGNvbnN0IG1hdGNoRGV0YWlscyA9IFtdO1xyXG4gIGNvbnN0IGJhdGNoU2l6ZSA9IDIwOyAvLyBQcm9jZXNzIDIwIHJlcXVlc3RzIGF0IGEgdGltZVxyXG4gIFxyXG4gIC8vIFNwbGl0IG1hdGNoSWRzIGludG8gYmF0Y2hlcyBvZiAyMFxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0Y2hJZHMubGVuZ3RoOyBpICs9IGJhdGNoU2l6ZSkge1xyXG4gICAgY29uc3QgYmF0Y2ggPSBtYXRjaElkcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKTtcclxuICAgIFxyXG4gICAgLy8gUHJvY2VzcyBiYXRjaFxyXG4gICAgY29uc3QgYmF0Y2hSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgIGJhdGNoLm1hcChtYXRjaElkID0+IGdldE1hdGNoRGV0YWlscyhtYXRjaElkLCByZWdpb24sIGFwaUtleSkpXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBtYXRjaERldGFpbHMucHVzaCguLi5iYXRjaFJlc3VsdHMpO1xyXG4gICAgXHJcbiAgICAvLyBJZiB0aGVyZSBhcmUgbW9yZSBiYXRjaGVzIHRvIHByb2Nlc3MsIHdhaXQgMSBzZWNvbmRcclxuICAgIGlmIChpICsgYmF0Y2hTaXplIDwgbWF0Y2hJZHMubGVuZ3RoKSB7XHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBtYXRjaERldGFpbHM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRldGVybWluZVJvbGUocGxheWVyU3RhdHM6IGFueSk6IHN0cmluZyB7XHJcbiAgLy8gVXNlIHRlYW1Qb3NpdGlvbiBhcyBwcmltYXJ5IGluZGljYXRvciAobW9zdCByZWxpYWJsZSBmb3IgcmFua2VkIGdhbWVzKVxyXG4gIGlmIChwbGF5ZXJTdGF0cy50ZWFtUG9zaXRpb24pIHtcclxuICAgIGNvbnN0IHBvc2l0aW9uczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcclxuICAgICAgJ1RPUCc6ICdUb3AnLFxyXG4gICAgICAnSlVOR0xFJzogJ0p1bmdsZScsXHJcbiAgICAgICdNSURETEUnOiAnTWlkJyxcclxuICAgICAgJ0JPVFRPTSc6ICdBREMnLFxyXG4gICAgICAnVVRJTElUWSc6ICdTdXBwb3J0J1xyXG4gICAgfTtcclxuICAgIHJldHVybiBwb3NpdGlvbnNbcGxheWVyU3RhdHMudGVhbVBvc2l0aW9uXSB8fCBwbGF5ZXJTdGF0cy50ZWFtUG9zaXRpb247XHJcbiAgfVxyXG5cclxuICAvLyBGYWxsYmFjayB0byBpbmRpdmlkdWFsUG9zaXRpb24gaWYgdGVhbVBvc2l0aW9uIGlzIG5vdCBhdmFpbGFibGVcclxuICBpZiAocGxheWVyU3RhdHMuaW5kaXZpZHVhbFBvc2l0aW9uICYmIHBsYXllclN0YXRzLmluZGl2aWR1YWxQb3NpdGlvbiAhPT0gJ0ludmFsaWQnKSB7XHJcbiAgICBjb25zdCBwb3NpdGlvbnM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XHJcbiAgICAgICdUT1AnOiAnVG9wJyxcclxuICAgICAgJ0pVTkdMRSc6ICdKdW5nbGUnLFxyXG4gICAgICAnTUlERExFJzogJ01pZCcsXHJcbiAgICAgICdCT1RUT00nOiAnQURDJyxcclxuICAgICAgJ1VUSUxJVFknOiAnU3VwcG9ydCdcclxuICAgIH07XHJcbiAgICByZXR1cm4gcG9zaXRpb25zW3BsYXllclN0YXRzLmluZGl2aWR1YWxQb3NpdGlvbl0gfHwgcGxheWVyU3RhdHMuaW5kaXZpZHVhbFBvc2l0aW9uO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuICdVbmtub3duJztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudERhdGEoZ2FtZU5hbWU6IHN0cmluZywgdGFnTGluZTogc3RyaW5nLCBhcGlLZXk6IHN0cmluZykge1xyXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICBgaHR0cHM6Ly9hbWVyaWNhcy5hcGkucmlvdGdhbWVzLmNvbS9yaW90L2FjY291bnQvdjEvYWNjb3VudHMvYnktcmlvdC1pZC8ke2VuY29kZVVSSUNvbXBvbmVudChnYW1lTmFtZSl9LyR7ZW5jb2RlVVJJQ29tcG9uZW50KHRhZ0xpbmUpfWAsXHJcbiAgICB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnWC1SaW90LVRva2VuJzogYXBpS2V5XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggYWNjb3VudCBkYXRhOicsIGF3YWl0IHJlc3BvbnNlLnRleHQoKSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldFN1bW1vbmVyRGF0YShwdXVpZDogc3RyaW5nLCByZWdpb246IHN0cmluZywgYXBpS2V5OiBzdHJpbmcpIHtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgYGh0dHBzOi8vJHtyZWdpb259LmFwaS5yaW90Z2FtZXMuY29tL2xvbC9zdW1tb25lci92NC9zdW1tb25lcnMvYnktcHV1aWQvJHtwdXVpZH1gLFxyXG4gICAge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ1gtUmlvdC1Ub2tlbic6IGFwaUtleVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHN1bW1vbmVyIGRhdGE6JywgYXdhaXQgcmVzcG9uc2UudGV4dCgpKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TWF0Y2hJZHMocHV1aWQ6IHN0cmluZywgcmVnaW9uOiBzdHJpbmcsIGFwaUtleTogc3RyaW5nKSB7XHJcbiAgY29uc3Qgcm91dGluZ1ZhbHVlID0gUkVHSU9OX1JPVVRJTkdbcmVnaW9uXSB8fCAnYW1lcmljYXMnO1xyXG4gIFxyXG4gIC8vIEZpcnN0IGdldCBhbGwgcmVjZW50IG1hdGNoZXMgd2l0aG91dCBxdWV1ZSBmaWx0ZXJcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgYGh0dHBzOi8vJHtyb3V0aW5nVmFsdWV9LmFwaS5yaW90Z2FtZXMuY29tL2xvbC9tYXRjaC92NS9tYXRjaGVzL2J5LXB1dWlkLyR7cHV1aWR9L2lkcz9zdGFydD0wJmNvdW50PTEwMGAsXHJcbiAgICB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnWC1SaW90LVRva2VuJzogYXBpS2V5XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggbWF0Y2ggSURzOicsIGF3YWl0IHJlc3BvbnNlLnRleHQoKSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGFsbE1hdGNoZXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgY29uc29sZS5sb2coYEZvdW5kICR7YWxsTWF0Y2hlcy5sZW5ndGh9IHRvdGFsIG1hdGNoZXNgKTtcclxuICBcclxuICAvLyBHZXQgZGV0YWlscyBmb3IgdGhlIGZpcnN0IGZldyBtYXRjaGVzIHRvIGRldGVybWluZSB0aGVpciBxdWV1ZSB0eXBlc1xyXG4gIGNvbnN0IGZpcnN0QmF0Y2ggPSBhbGxNYXRjaGVzLnNsaWNlKDAsIDIwKTsgLy8gQ2hlY2sgZmlyc3QgMjAgbWF0Y2hlc1xyXG4gIGNvbnN0IG1hdGNoRGV0YWlscyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgZmlyc3RCYXRjaC5tYXAoKG1hdGNoSWQ6IHN0cmluZykgPT4gZ2V0TWF0Y2hEZXRhaWxzKG1hdGNoSWQsIHJlZ2lvbiwgYXBpS2V5KSlcclxuICApO1xyXG5cclxuICAvLyBGaWx0ZXIgZm9yIHJhbmtlZCBnYW1lcyAocXVldWUgSURzIDQyMCBhbmQgNDQwKVxyXG4gIGNvbnN0IHJhbmtlZE1hdGNoZXMgPSBtYXRjaERldGFpbHNcclxuICAgIC5maWx0ZXIobWF0Y2ggPT4gbWF0Y2ggIT09IG51bGwgJiYgKG1hdGNoLmluZm8ucXVldWVJZCA9PT0gNDIwIHx8IG1hdGNoLmluZm8ucXVldWVJZCA9PT0gNDQwKSlcclxuICAgIC5tYXAobWF0Y2ggPT4gbWF0Y2gubWV0YWRhdGEubWF0Y2hJZCk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGBGb3VuZCAke3JhbmtlZE1hdGNoZXMubGVuZ3RofSByYW5rZWQgbWF0Y2hlcyBvdXQgb2YgJHtmaXJzdEJhdGNoLmxlbmd0aH0gY2hlY2tlZCBtYXRjaGVzYCk7XHJcbiAgXHJcbiAgcmV0dXJuIHJhbmtlZE1hdGNoZXM7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBnYW1lTmFtZSwgdGFnTGluZSwgcmVnaW9uID0gJ25hMScgfSA9IHJlcS5xdWVyeSBhcyB7IFxyXG4gICAgICBnYW1lTmFtZTogc3RyaW5nLCBcclxuICAgICAgdGFnTGluZTogc3RyaW5nLCBcclxuICAgICAgcmVnaW9uOiBzdHJpbmcgXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBpZiAoIWdhbWVOYW1lIHx8ICF0YWdMaW5lKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnR2FtZSBuYW1lIGFuZCB0YWcgbGluZSBhcmUgcmVxdWlyZWQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghcHJvY2Vzcy5lbnYuUklPVF9BUElfS0VZKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1JJT1RfQVBJX0tFWSBpcyBub3Qgc2V0IGluIGVudmlyb25tZW50IHZhcmlhYmxlcycpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ1NlcnZlciBjb25maWd1cmF0aW9uIGVycm9yJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgRmV0Y2hpbmcgZGF0YSBmb3IgJHtnYW1lTmFtZX0jJHt0YWdMaW5lfSBpbiByZWdpb24gJHtyZWdpb259YCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTdGVwIDE6IEdldCBQVVVJRCB1c2luZyBSaW90IElEXHJcbiAgICAgIGNvbnN0IGFjY291bnREYXRhID0gYXdhaXQgZ2V0QWNjb3VudERhdGEoZ2FtZU5hbWUsIHRhZ0xpbmUsIHByb2Nlc3MuZW52LlJJT1RfQVBJX0tFWSk7XHJcbiAgICAgIGlmICghYWNjb3VudERhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdBY2NvdW50IG5vdCBmb3VuZCBmb3I6JywgZ2FtZU5hbWUsIHRhZ0xpbmUpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnQWNjb3VudCBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCdBY2NvdW50IGZvdW5kOicsIGFjY291bnREYXRhLnB1dWlkKTtcclxuXHJcbiAgICAgIC8vIFN0ZXAgMjogR2V0IHN1bW1vbmVyIGRhdGEgdXNpbmcgUFVVSURcclxuICAgICAgY29uc3Qgc3VtbW9uZXJEYXRhID0gYXdhaXQgZ2V0U3VtbW9uZXJEYXRhKGFjY291bnREYXRhLnB1dWlkLCByZWdpb24sIHByb2Nlc3MuZW52LlJJT1RfQVBJX0tFWSk7XHJcbiAgICAgIGlmICghc3VtbW9uZXJEYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignU3VtbW9uZXIgZGF0YSBub3QgZm91bmQgZm9yIFBVVUlEOicsIGFjY291bnREYXRhLnB1dWlkKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1N1bW1vbmVyIGRhdGEgbm90IGZvdW5kJyB9KTtcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZygnU3VtbW9uZXIgZGF0YSBmb3VuZDonLCBzdW1tb25lckRhdGEuaWQpO1xyXG5cclxuICAgICAgLy8gU3RlcCAzOiBHZXQgcmFua2VkIHN0YXRzXHJcbiAgICAgIGNvbnN0IHJhbmtlZFN0YXRzID0gYXdhaXQgZ2V0UmFua2VkU3RhdHMoc3VtbW9uZXJEYXRhLmlkLCByZWdpb24sIHByb2Nlc3MuZW52LlJJT1RfQVBJX0tFWSk7XHJcbiAgICAgIGlmICghcmFua2VkU3RhdHMpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ05vIHJhbmtlZCBzdGF0cyBmb3VuZCBmb3Igc3VtbW9uZXI6Jywgc3VtbW9uZXJEYXRhLmlkKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgcmFua2VkIHN0YXRzOicsIHJhbmtlZFN0YXRzLmxlbmd0aCwgJ3F1ZXVlcycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTdGVwIDQ6IEdldCBtYXRjaCBJRHNcclxuICAgICAgY29uc3QgbWF0Y2hJZHMgPSBhd2FpdCBnZXRNYXRjaElkcyhhY2NvdW50RGF0YS5wdXVpZCwgcmVnaW9uLCBwcm9jZXNzLmVudi5SSU9UX0FQSV9LRVkpO1xyXG4gICAgICBpZiAoIW1hdGNoSWRzIHx8IG1hdGNoSWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIG1hdGNoZXMgZm91bmQgZm9yIFBVVUlEOicsIGFjY291bnREYXRhLnB1dWlkKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBcclxuICAgICAgICAgIGVycm9yOiAnTm8gcmFua2VkIG1hdGNoZXMgZm91bmQnLFxyXG4gICAgICAgICAgZGV0YWlsczogJ1RoZSBwbGF5ZXIgaGFzIG5vIHJlY2VudCByYW5rZWQgZ2FtZXMgaW4gU29sbyBRdWV1ZSBvciBGbGV4IFF1ZXVlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCAke21hdGNoSWRzLmxlbmd0aH0gdG90YWwgbWF0Y2hlc2ApO1xyXG5cclxuICAgICAgLy8gU3RlcCA1OiBHZXQgbWF0Y2ggZGV0YWlscyB3aXRoIHJhdGUgbGltaXRpbmdcclxuICAgICAgY29uc29sZS5sb2coYEZldGNoaW5nIGRldGFpbHMgZm9yICR7bWF0Y2hJZHMubGVuZ3RofSBtYXRjaGVzLi4uYCk7XHJcbiAgICAgIGNvbnN0IG1hdGNoRGV0YWlscyA9IGF3YWl0IGdldE1hdGNoRGV0YWlsc1dpdGhSYXRlTGltaXQobWF0Y2hJZHMuc2xpY2UoMCwgMjApLCByZWdpb24sIHByb2Nlc3MuZW52LlJJT1RfQVBJX0tFWSk7XHJcbiAgICAgIGNvbnN0IHZhbGlkTWF0Y2hlcyA9IG1hdGNoRGV0YWlscy5maWx0ZXIobWF0Y2ggPT4gbWF0Y2ggIT09IG51bGwpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHZhbGlkTWF0Y2hlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdObyB2YWxpZCBtYXRjaGVzIGZvdW5kIGFmdGVyIGZpbHRlcmluZycpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IFxyXG4gICAgICAgICAgZXJyb3I6ICdObyB2YWxpZCBtYXRjaGVzIGZvdW5kJyxcclxuICAgICAgICAgIGRldGFpbHM6ICdDb3VsZCBub3QgcmV0cmlldmUgZGV0YWlscyBmb3IgYW55IG9mIHRoZSBtYXRjaGVzJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKGBTdWNjZXNzZnVsbHkgZmV0Y2hlZCAke3ZhbGlkTWF0Y2hlcy5sZW5ndGh9IHZhbGlkIG1hdGNoZXMgb3V0IG9mICR7bWF0Y2hJZHMubGVuZ3RofSB0b3RhbCBtYXRjaGVzYCk7XHJcblxyXG4gICAgICAvLyBTdGVwIDY6IENhbGN1bGF0ZSBzdGF0c1xyXG4gICAgICBjb25zdCBjaGFtcGlvblN0YXRzID0gY2FsY3VsYXRlQ2hhbXBpb25TdGF0cyh2YWxpZE1hdGNoZXMsIGFjY291bnREYXRhLnB1dWlkKTtcclxuICAgICAgY29uc3Qgcm9sZVN0YXRzID0gY2FsY3VsYXRlUm9sZVN0YXRzKHZhbGlkTWF0Y2hlcywgYWNjb3VudERhdGEucHV1aWQpO1xyXG4gICAgICBjb25zdCBtYWluUm9sZSA9IE9iamVjdC5lbnRyaWVzKHJvbGVTdGF0cylcclxuICAgICAgICAuc29ydCgoW18sIGFdLCBbX18sIGJdKSA9PiAoYiBhcyBSb2xlU3RhdHMpLmdhbWVzIC0gKGEgYXMgUm9sZVN0YXRzKS5nYW1lcylcclxuICAgICAgICAubWFwKChbcm9sZSwgc3RhdHNdKSA9PiAoe1xyXG4gICAgICAgICAgcm9sZSxcclxuICAgICAgICAgIHN0YXRzXHJcbiAgICAgICAgfSkpWzBdO1xyXG5cclxuICAgICAgLy8gU3RlcCA3OiBDcmVhdGUgY29hY2hpbmcgcHJvbXB0XHJcbiAgICAgIGNvbnN0IGNvYWNoaW5nUHJvbXB0ID0gY3JlYXRlQ29hY2hpbmdQcm9tcHQocmFua2VkU3RhdHMsIGNoYW1waW9uU3RhdHMsIHJvbGVTdGF0cyk7XHJcblxyXG4gICAgICAvLyBSZXR1cm4gYWxsIGRhdGFcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIGFjY291bnQ6IGFjY291bnREYXRhLFxyXG4gICAgICAgIHN1bW1vbmVyOiBzdW1tb25lckRhdGEsXHJcbiAgICAgICAgcmFua2VkU3RhdHMsXHJcbiAgICAgICAgY2hhbXBpb25TdGF0cyxcclxuICAgICAgICByb2xlU3RhdHMsXHJcbiAgICAgICAgbWFpblJvbGUsXHJcbiAgICAgICAgY29hY2hpbmdQcm9tcHQsXHJcbiAgICAgICAgZGVidWc6IHtcclxuICAgICAgICAgIHRvdGFsTWF0Y2hlczogbWF0Y2hJZHMubGVuZ3RoLFxyXG4gICAgICAgICAgdmFsaWRNYXRjaGVzOiB2YWxpZE1hdGNoZXMubGVuZ3RoLFxyXG4gICAgICAgICAgcHJvY2Vzc2VkQ2hhbXBpb25zOiBjaGFtcGlvblN0YXRzLmxlbmd0aCxcclxuICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxyXG4gICAgICAgICAgcm91dGluZ1ZhbHVlOiBSRUdJT05fUk9VVElOR1tyZWdpb25dIHx8ICdhbWVyaWNhcydcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRGV0YWlsZWQgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGRhdGEnLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxyXG4gICAgICAgIHBhdGg6IGVycm9yPy5yZXNwb25zZT8udXJsIHx8ICdVbmtub3duIHBhdGgnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RldGFpbGVkIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdCcsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJSRUdJT05fUk9VVElORyIsImdldE1hdGNoRGV0YWlscyIsIm1hdGNoSWQiLCJyZWdpb24iLCJhcGlLZXkiLCJyb3V0aW5nVmFsdWUiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsIm9rIiwiY29uc29sZSIsImVycm9yIiwidGV4dCIsImpzb24iLCJnZXRSYW5rZWRTdGF0cyIsInN1bW1vbmVySWQiLCJjYWxjdWxhdGVDaGFtcGlvblN0YXRzIiwibWF0Y2hlcyIsInB1dWlkIiwibGVuZ3RoIiwid2FybiIsImNoYW1waW9uU3RhdHMiLCJ2YWxpZE1hdGNoZXNDb3VudCIsImZvckVhY2giLCJtYXRjaCIsImluZGV4IiwiaW5mbyIsImdhbWVEdXJhdGlvbiIsImxvZyIsImdhbWVJZCIsInF1ZXVlSWQiLCJwbGF5ZXJTdGF0cyIsInBhcnRpY2lwYW50cyIsImZpbmQiLCJwIiwiY2hhbXBpb25OYW1lIiwiZ2FtZUR1cmF0aW9uTWludXRlcyIsImdhbWVzUGxheWVkIiwid2lucyIsInRvdGFsS2lsbHMiLCJ0b3RhbERlYXRocyIsInRvdGFsQXNzaXN0cyIsInRvdGFsQ1MiLCJ0b3RhbEdhbWVEdXJhdGlvbiIsInRvdGFsVmlzaW9uU2NvcmUiLCJ3aW4iLCJraWxscyIsImRlYXRocyIsImFzc2lzdHMiLCJ0b3RhbE1pbmlvbnNLaWxsZWQiLCJuZXV0cmFsTWluaW9uc0tpbGxlZCIsInZpc2lvblNjb3JlIiwiT2JqZWN0IiwidmFsdWVzIiwibWFwIiwic3RhdHMiLCJ3aW5SYXRlIiwidG9GaXhlZCIsImF2Z0tpbGxzIiwiYXZnRGVhdGhzIiwiYXZnQXNzaXN0cyIsImtkYSIsIk1hdGgiLCJtYXgiLCJhdmdDU1Blck1pbiIsImF2Z0NTUGVyR2FtZSIsInJvdW5kIiwiYXZnVmlzaW9uU2NvcmUiLCJzb3J0IiwiYSIsImIiLCJjYWxjdWxhdGVSb2xlU3RhdHMiLCJyb2xlU3RhdHMiLCJUb3AiLCJnYW1lcyIsInBlcmNlbnRhZ2UiLCJKdW5nbGUiLCJNaWQiLCJBREMiLCJTdXBwb3J0IiwidmFsaWRNYXRjaGVzIiwiZmlsdGVyIiwicm9sZSIsImRldGVybWluZVJvbGUiLCJ0b3RhbEdhbWVzIiwia2V5cyIsImNyZWF0ZUNvYWNoaW5nUHJvbXB0IiwicmFua2VkU3RhdHMiLCJzb2xvUXVldWUiLCJxdWV1ZSIsInF1ZXVlVHlwZSIsInJhbmtlZEluZm8iLCJ0aWVyIiwicmFuayIsImxlYWd1ZVBvaW50cyIsImxvc3NlcyIsInJvbGVTZWN0aW9uIiwiZW50cmllcyIsIl8iLCJfXyIsImpvaW4iLCJjaGFtcGlvblNlY3Rpb24iLCJjaGFtcCIsImdldE1hdGNoRGV0YWlsc1dpdGhSYXRlTGltaXQiLCJtYXRjaElkcyIsIm1hdGNoRGV0YWlscyIsImJhdGNoU2l6ZSIsImkiLCJiYXRjaCIsInNsaWNlIiwiYmF0Y2hSZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsInB1c2giLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInRlYW1Qb3NpdGlvbiIsInBvc2l0aW9ucyIsImluZGl2aWR1YWxQb3NpdGlvbiIsImdldEFjY291bnREYXRhIiwiZ2FtZU5hbWUiLCJ0YWdMaW5lIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZ2V0U3VtbW9uZXJEYXRhIiwiZ2V0TWF0Y2hJZHMiLCJhbGxNYXRjaGVzIiwiZmlyc3RCYXRjaCIsInJhbmtlZE1hdGNoZXMiLCJtZXRhZGF0YSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJxdWVyeSIsInN0YXR1cyIsInByb2Nlc3MiLCJlbnYiLCJSSU9UX0FQSV9LRVkiLCJhY2NvdW50RGF0YSIsInN1bW1vbmVyRGF0YSIsImlkIiwiZGV0YWlscyIsIm1haW5Sb2xlIiwiY29hY2hpbmdQcm9tcHQiLCJhY2NvdW50Iiwic3VtbW9uZXIiLCJkZWJ1ZyIsInRvdGFsTWF0Y2hlcyIsInByb2Nlc3NlZENoYW1waW9ucyIsIkVycm9yIiwibWVzc2FnZSIsInBhdGgiLCJ1cmwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/summoner.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsummoner&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Csummoner.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();